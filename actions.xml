<?xml version="1.0" encoding="utf-8"?>
<remv1:Remediation-Plugin xmlns:remv1="RemediationVersion1.xsd" Name="Cb Response" Version="1" IsLogRhythmPlugin="true" Guid="0f4ec3f0-ae7d-486b-bbea-f33ed3acee71">
  <!-- Kill Process on Remote System -->
  <remv1:Action Name="Cb Response : Kill Process" Command="powershell.exe">
    <remv1:ConstantParameter Name="Script" Switch="-file Cb_Response.ps1" Order="1" />
    <remv1:StringParameter Name="Host" Switch="-hostname " Order="2">
      <remv1:DefaultInput>
        <remv1:DHostName />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Command" Switch="-command " Order="3">
      <remv1:DefaultInput>
        <remv1:StaticInput Value="kill" />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Process ID" Switch="-object " Order="4" />
    <remv1:EncryptedParameter>
      <remv1:StringParameter Name="API Key" Switch="-key " Order="5" />
    </remv1:EncryptedParameter>
    <remv1:StringParameter Name="Carbon Black Server URL" Switch="-baseURL " Order="6" />
  </remv1:Action>
  <!-- Get File on Remote Host -->
  <remv1:Action Name="Cb Response : Get File" Command="powershell.exe">
    <remv1:ConstantParameter Name="Script" Switch="-file Cb_Response.ps1" Order="1" />
    <remv1:StringParameter Name="Host" Switch="-hostname " Order="2">
      <remv1:DefaultInput>
        <remv1:DHostName />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Command" Switch="-command " Order="3">
      <remv1:DefaultInput>
        <remv1:StaticInput Value="get" />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Path of Remote File" Switch="-object " Order="4" />
    <remv1:EncryptedParameter>
      <remv1:StringParameter Name="API Key" Switch="-key " Order="5" />
    </remv1:EncryptedParameter>
    <remv1:StringParameter Name="Local Output Directory" Switch="-location " Order="6" />
    <remv1:StringParameter Name="Carbon Black Server URL" Switch="-baseURL " Order="7" />
  </remv1:Action>
  <!-- Isolate Remote Host Networking -->
  <remv1:Action Name="Cb Response : Isolate Host" Command="powershell.exe">
    <remv1:ConstantParameter Name="Script" Switch="-file Cb_Response.ps1" Order="1" />
    <remv1:StringParameter Name="Host" Switch="-hostname " Order="2">
      <remv1:DefaultInput>
        <remv1:DHostName />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Command" Switch="-command " Order="3">
      <remv1:DefaultInput>
        <remv1:StaticInput Value="isolate" />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Enable network isolation (true/false)" Switch="-object " Order="4" />
    <remv1:EncryptedParameter>
      <remv1:StringParameter Name="API Key" Switch="-key " Order="5" />
    </remv1:EncryptedParameter>
    <remv1:StringParameter Name="Carbon Black Server URL" Switch="-baseURL " Order="6" />
  </remv1:Action>
  <!-- Delete File on Remote Host -->
  <remv1:Action Name="Cb Response : Delete File" Command="powershell.exe">
    <remv1:ConstantParameter Name="Script" Switch="-file Cb_Response.ps1" Order="1" />
    <remv1:StringParameter Name="Host" Switch="-hostname " Order="2">
      <remv1:DefaultInput>
        <remv1:DHostName />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Command" Switch="-command " Order="3">
      <remv1:DefaultInput>
        <remv1:StaticInput Value="delete" />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Path to Remote File" Switch="-object " Order="4" />
    <remv1:EncryptedParameter>
      <remv1:StringParameter Name="API Key" Switch="-key " Order="5" />
    </remv1:EncryptedParameter>
    <remv1:StringParameter Name="Carbon Black Server URL" Switch="-baseURL " Order="6" />
  </remv1:Action>
  <!-- Dump Remote Host Memory -->
  <remv1:Action Name="Cb Response : Dump Memory" Command="powershell.exe">
    <remv1:ConstantParameter Name="Script" Switch="-file Cb_Response.ps1" Order="1" />
    <remv1:StringParameter Name="Host" Switch="-hostname " Order="2">
      <remv1:DefaultInput>
        <remv1:DHostName />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Command" Switch="-command " Order="3">
      <remv1:DefaultInput>
        <remv1:StaticInput Value="memdump" />
      </remv1:DefaultInput>
    </remv1:StringParameter>
    <remv1:StringParameter Name="Remote Output Path" Switch="-object " Order="4" />
    <remv1:EncryptedParameter>
      <remv1:StringParameter Name="API Key" Switch="-key " Order="5" />
    </remv1:EncryptedParameter>
    <remv1:StringParameter Name="Carbon Black Server URL" Switch="-baseURL " Order="6" />
  </remv1:Action>
</remv1:Remediation-Plugin>